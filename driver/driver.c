
NTSTATUS entry(_DRIVER_OBJECT *DriverObject,_UNICODE_STRING *RegistryPath)

{
  void *_Dst;
  NTSTATUS NVar1;
  _DEVICE_OBJECT *local_98;
  _UNICODE_STRING local_90;
  _UNICODE_STRING local_80;
  undefined8 local_70 [5];
  undefined8 local_48 [6];
  ulonglong local_18;
  
  if (((DAT_00013100 == 0) || (DAT_00013100 == 0x2b992ddfa232)) &&
     (DAT_00013100 = (_DAT_fffff78000000320 ^ 0x13100) & 0xffffffffffff, DAT_00013100 == 0)) {
    DAT_00013100 = 0x2b992ddfa232;
  }
  DAT_00013108 = ~DAT_00013100;
  local_18 = DAT_00013100 ^ (ulonglong)&stack0xffffffffffffff28;
  CopyMemoryBlock(local_70,(undefined8 *)L"\\Device\\DBUtil_2_3",0x26);
  CopyMemoryBlock(local_48,(undefined8 *)L"\\DosDevices\\DBUtil_2_3",0x2e);
  RtlInitUnicodeString(&local_90,(wchar_t *)local_70);
  RtlInitUnicodeString(&local_80,(wchar_t *)local_48);
  NVar1 = IoCreateDevice(DriverObject,0xa0,&local_90,0x9b0c,0,'\x01',&local_98);
  if (NVar1 == 0) {
    NVar1 = IoCreateSymbolicLink(&local_80,&local_90);
    if (NVar1 == 0) {
      *(code **)&DriverObject->DispatchShutdown = ioctl;
      *(code **)&DriverObject->DispatchCreate = ioctl;
      *(code **)&DriverObject->DispatchClose = ioctl;
      *(code **)&DriverObject->DispatchDeviceIOControl = ioctl;
      _Dst = local_98->DeviceExtension;
      memset(_Dst,0,0xa0);
      *(undefined8 *)((longlong)_Dst + 0x10) = 0;
      KeInitializeDpc((longlong)_Dst + 0x18,unk_DONOTEXECUTE1,_Dst);
      KeSetTargetProcessorDpc((longlong)_Dst + 0x18,0);
      KeSetImportanceDpc((longlong)_Dst + 0x18,2);
    }
    else {
      IoDeleteDevice(local_98);
    }
  }
  NVar1 = FUN_00011730(local_18 ^ (ulonglong)&stack0xffffffffffffff28);
  return NVar1;
}
